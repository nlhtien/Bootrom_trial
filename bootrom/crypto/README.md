# Cryptographic Subsystem

This directory provides a unified cryptographic layer for the BootROM, abstracting the underlying implementation details (Software, PSA, or Hardware).

## Directory Structure

- **`crypto_wrapper.c/h`**: The main API used by the BootROM application.
- **`crypto_common.c/h`**: Security utilities (secure zeroize, constant-time comparison) and shared macros.
- **`crypto_config.h`**: Build-time configuration (generated by CMake).
- **`backends/`**: Specific implementations selectable via config:
  - `crypto_sw`: Pure software (MbedTLS primitives).
  - `crypto_pk`: High-level PK layer (supports ASN.1 DER keys).
  - `crypto_psa`: ARM PSA Crypto API standard.
  - `crypto_hw`: Hardware acceleration stubs.

## Supported Operations

- **Hashing**: SHA-256, SHA-384.
- **Decryption**: AES-256 (CBC and GCM modes).
- **Verification**: RSA (2048/3072/4096) and ECDSA (SECP256R1/SECP384R1).
- **TRNG**: True Random Number Generator interface.

## Configuration

Use `crypto_config.h` to optimize for ROM size and Hardware features:
- Enable/Disable specific algorithms (e.g., disable GCM to save space).
- Select the active backend.
- Configure the static heap size.

## Memory Management

Designed strictly for BootROM constraints:
- **No Dynamic Allocation**: Uses a static internal heap (no `malloc`/`free`).
- **Secure Cleanup**: All keys and sensitive data are securely zeroized from the stack/heap before exit.